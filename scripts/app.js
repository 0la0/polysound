!function e(t,n,r){function i(u,a){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=e("./init.js"),o=e("./connector/connectionBus.js"),u=r(o);!function(e){var t=e.querySelector("#app");t.audio=i.audio,t.connectionBusses={drivers:new u["default"],instruments:new u["default"],effects1:new u["default"],effects2:new u["default"]},t.scheduler=i.scheduler,t.baseUrl="/",""===window.location.port,t.displayInstalledToast=function(){Polymer.dom(e).querySelector("platinum-sw-cache").disabled||Polymer.dom(e).querySelector("#caching-complete").show()},t.addEventListener("dom-change",function(){})}(document)},{"./connector/connectionBus.js":22,"./init.js":25}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("../util/uniqueGenerator.js"),a=r(u),s=function(){function e(t){i(this,e),this.audioContext=t,this.mainGain=t.createGain(),this.uniqueId=(0,a["default"])()}return o(e,[{key:"getInput",value:function(){return this.input}},{key:"getOutput",value:function(){return this.mainGain}},{key:"connectTo",value:function(e){this.mainGain.connect(e)}}]),e}();n["default"]=s},{"../util/uniqueGenerator.js":21}],3:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){for(var r=new Float32Array(t),i=0;t>i;i++){var o=2*i/t-1;r[i]=e(o,n,t)}return r}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var c=e("./BaseEffect.js"),f=r(c),l=function(e){function t(e,n){i(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e));return r.input=r.audioContext.createGain(),r.waveshaperNode=r.audioContext.createWaveShaper(),r.input.connect(r.waveshaperNode),r.waveshaperNode.connect(r.mainGain),r}return u(t,e),s(t,[{key:"getCarrierFunctions",value:function(){return Object.keys(h)}},{key:"setCarrierFunction",value:function(e){var t=h[e];t?this.waveshaperNode.curve=a(t,this.audioContext.sampleRate,50):console.warn("Waveshkaper.setCarrierFunction error, invalid function key")}}]),t}(f["default"]);n["default"]=l;var h={Square:function(e){return Math.pow(e,2)},Cubed:function(e){return Math.pow(e,3)},Chebyshev2:function(e){return 2*Math.pow(e,2)-1},Chebyshev3:function(e){return 4*Math.pow(e,3)-3*e},Chebyshev4:function(e){return 8*Math.pow(e,4)-8*Math.pow(e,2)+1},Sigmoid:function(e){return 2/(1+Math.exp(-4*e))-1},Sigmoid2:function(e){return 1.5/(1+Math.exp(-10*e))-.75},SigmoidLike:function(e,t){return(3+t)*e*20*(Math.PI/180)/(Math.PI+t*Math.abs(e))},HardClip:function(e,t,n){return(1+.4*e)/(1+Math.abs(e))}}},{"./BaseEffect.js":2}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./BaseEffect.js"),s=r(a),c=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.input=n.audioContext.createDynamicsCompressor(),n.input.connect(n.mainGain),n.input.threshold.value=-50,n.input.knee.value=40,n.input.ratio.value=12,n.input.reduction.value=-20,n.input.attack.value=0,n.input.release.value=.25,n}return u(t,e),t}(s["default"]);n["default"]=c},{"./BaseEffect.js":2}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("./BaseEffect.js"),c=r(s),f=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.input=n.audioContext.createDelay(),n.feedback=n.audioContext.createGain(),n.wetLevel=n.audioContext.createGain(),n.feedback.gain.value=.85,n.wetLevel.gain.value=.8,n.connectDelayNodes(),n}return u(t,e),a(t,[{key:"setQuatization",value:function(e,t){var n=this;this.disconnectDelayNodes(),setTimeout(function(){n.connectDelayNodes(),n.input.delayTime.value=e/1e3/t},0)}},{key:"disconnectDelayNodes",value:function(){this.input.disconnect(this.wetLevel),this.input.disconnect(this.feedback),this.wetLevel.disconnect(this.mainGain)}},{key:"connectDelayNodes",value:function(){this.wetLevel.connect(this.mainGain),this.feedback.connect(this.input),this.input.connect(this.wetLevel),this.input.connect(this.feedback)}}]),t}(c["default"]);n["default"]=f},{"./BaseEffect.js":2}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n,r){for(var i=[],o=0;e>o;o++){var u=r.createBiquadFilter();u.type="bandpass",u.Q.value=50,i.push(u)}return i}function s(e,t){var n=Math.floor(t.length*Math.random()),r=t[n],i=Math.pow(2,1/12),o=e*Math.pow(i,r);return o}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var f=e("./BaseEffect.js"),l=r(f),h=function(e){function t(e,n,r){i(this,t);var u=o(this,Object.getPrototypeOf(t).call(this,e)),s=40;return u.scale=[0,2,4,6,7,9,11,12],u.baseFrequency=440,u.input=u.audioContext.createGain(),u.filterArray=a(s,u.baseFrequency,u.scale,u.audioContext),u.filterArray.forEach(function(e){e.connect(u.mainGain),u.input.connect(e)}),u.setBaseFrequency(u.baseFrequency),u}return u(t,e),c(t,[{key:"setBaseFrequency",value:function(e){var t=this;this.baseFrequency=e,this.filterArray.forEach(function(e){e.connect(t.mainGain),t.input.connect(e),e.frequency.value=s(t.baseFrequency,t.scale)})}}]),t}(l["default"]);n["default"]=h},{"./BaseEffect.js":2}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("./equalizer.js"),a=r(u),s=e("./delay.js"),c=r(s),f=e("./reverb.js"),l=r(f),h=e("./compressor.js"),d=r(h),p=e("./droneFilter.js"),y=r(p),v=e("./Waveshaper.js"),b=r(v),m=function(){function e(t){i(this,e),this.audioContext=t,this.reverbBufferMap=new Map}return o(e,[{key:"createEqualizer",value:function(){return new a["default"](this.audioContext)}},{key:"createDelay",value:function(){return new c["default"](this.audioContext)}},{key:"createReverb",value:function(e){return e||(e=Array.from(this.reverbBufferMap.keys())[0]),new l["default"](this.audioContext,this.reverbBufferMap.get(e))}},{key:"addReverbBuffer",value:function(e,t){this.reverbBufferMap.set(e,t)}},{key:"createCompressor",value:function(){return new d["default"](this.audioContext)}},{key:"createDroneFilter",value:function(){return new y["default"](this.audioContext)}},{key:"createWaveshaper",value:function(){return new b["default"](this.audioContext)}}]),e}();n["default"]=m},{"./Waveshaper.js":3,"./compressor.js":4,"./delay.js":5,"./droneFilter.js":6,"./equalizer.js":8,"./reverb.js":9}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./BaseEffect.js"),s=r(a),c=function(e){function t(e,n,r){i(this,t);var u=o(this,Object.getPrototypeOf(t).call(this,e));return u.lo=u.audioContext.createBiquadFilter(),u.lo.type="lowshelf",u.lo.frequency.value=300,u.mid=u.audioContext.createBiquadFilter(),u.mid.type="peaking",u.mid.frequency.value=1e3,u.hi=u.audioContext.createBiquadFilter(),u.hi.type="highshelf",u.hi.frequency.value=7e3,u.hi.connect(u.mainGain),u.mid.connect(u.hi),u.lo.connect(u.mid),u.lo.gain.value=0,u.mid.gain.value=0,u.hi.gain.value=0,u.mainGain.gain.value=.5,u.input=u.lo,u}return u(t,e),t}(s["default"]);n["default"]=c},{"./BaseEffect.js":2}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("./BaseEffect.js"),c=r(s),f=function(e){function t(e,n){i(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e));return r.input=r.audioContext.createConvolver(),r.input.connect(r.mainGain),n&&r.setBuffer(n),r}return u(t,e),a(t,[{key:"setBuffer",value:function(e){this.input.buffer=e}}]),t}(c["default"]);n["default"]=f},{"./BaseEffect.js":2}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("./BaseEffect.js"),c=r(s),f=function(e){function t(e,n){i(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e));return r.source=n,r.analyser=r.audioContext.createAnalyser(),r.analyser.fftSize=Math.pow(2,11),r.timeDataArray=new Uint8Array(r.getBufferLength()),r.freqDataArray=new Uint8Array(r.getBufferLength()),r}return u(t,e),a(t,[{key:"connect",value:function(){this.source.connect(this.analyser)}},{key:"disconnect",value:function(){this.source.disconnect(this.analyser)}},{key:"getBufferLength",value:function(){return this.analyser.frequencyBinCount}},{key:"getTimeData",value:function(){return this.analyser.getByteTimeDomainData(this.timeDataArray),this.timeDataArray}},{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.freqDataArray),this.freqDataArray}}]),t}(c["default"]);n["default"]=f},{"./BaseEffect.js":2}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("../util/uniqueGenerator.js"),a=r(u),s=function(){function e(t){i(this,e),this.audioContext=t,this.input=this.audioContext.createGain(),this.semitoneRatio=Math.pow(2,1/12),this.uniqueId=(0,a["default"])(),this.adsr={attack:.01,decay:0,sustain:.5,release:.1}}return o(e,[{key:"getOutput",value:function(){return this.input}},{key:"connectTo",value:function(e){this.input.connect(e)}},{key:"setAttack",value:function(e){this.adsr.attack=e}},{key:"setDecay",value:function(e){this.adsr.decay=e}},{key:"setSustain",value:function(e){this.adsr.sustain=e}},{key:"setRelease",value:function(e){this.adsr.release=e}},{key:"getPlayLength",value:function(){var e=this;return Object.keys(this.adsr).reduce(function(t,n){return t+e.adsr[n]},0)}}]),e}();n["default"]=s},{"../util/uniqueGenerator.js":21}],12:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n=new Float32Array(e);return t.reduce(function(e,t){return n.set(t,e),e+t.length},0),n}function s(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia}var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var f=e("./baseInstrument.js"),l=r(f),h=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.inputSource=null,n.recordingScriptNode=null,n}return u(t,e),c(t,[{key:"turnOnInput",value:function(){var e=this;navigator.getUserMedia({audio:!0},function(t){e.inputSource=e.audioContext.createMediaStreamSource(t),e.inputSource.connect(e.input)},function(e){console.log("Error: InputNode.getUserMedia:",e)})}},{key:"turnOffInput",value:function(){this.inputSource&&(this.inputSource.disconnect(this.input),this.inputSource=null)}},{key:"resetRecordingData",value:function(){this.recordingData={sampleRate:this.audioContext.sampleRate,bufferSize:Math.pow(2,11),length:0,leftChannel:[],rightChannel:[]}}},{key:"startRecording",value:function(){var e=this;this.resetRecordingData(),this.recordingScriptNode=this.audioContext.createScriptProcessor(this.recordingData.bufferSize,2,2),this.recordingScriptNode.onaudioprocess=function(t){e.recordingData.leftChannel.push(new Float32Array(t.inputBuffer.getChannelData(0))),e.recordingData.rightChannel.push(new Float32Array(t.inputBuffer.getChannelData(1))),e.recordingData.length+=e.recordingData.bufferSize},this.inputSource.connect(this.recordingScriptNode),this.recordingScriptNode.connect(this.audioContext.destination)}},{key:"stopRecording",value:function(){this.inputSource.disconnect(this.recordingScriptNode),this.recordingScriptNode.disconnect(this.audioContext.destination),this.recordingScriptNode=null;var e=a(this.recordingData.length,this.recordingData.leftChannel),t=a(this.recordingData.length,this.recordingData.rightChannel),n=this.audioContext.createBuffer(2,this.recordingData.length,this.recordingData.sampleRate);n.getChannelData(0).set(e),n.getChannelData(1).set(t);var r=(new Date).getTime()+"";app.audio.sampleMap.set(r,n)}}]),t}(l["default"]);n["default"]=h,s()},{"./baseInstrument.js":11}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("./sampler.js"),a=r(u),s=e("./synth.js"),c=r(s),f=e("./inputNode.js"),l=r(f),h=e("./whiteNoise.js"),d=r(h),p=function(){function e(t){i(this,e),this.audioContext=t}return o(e,[{key:"createSynth",value:function(){return new c["default"](this.audioContext)}},{key:"createSampler",value:function(e){return new a["default"](this.audioContext,e)}},{key:"createInputNode",value:function(){return new l["default"](this.audioContext)}},{key:"createWhiteNoiseNode",value:function(){return new d["default"](this.audioContext)}}]),e}();n["default"]=p},{"./inputNode.js":12,"./sampler.js":14,"./synth.js":15,"./whiteNoise.js":16}],14:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("./baseInstrument.js"),c=r(s),f=e("../util/adsr.js"),l=r(f),h=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.hasSample=!1,n.baseNote=0,n}return u(t,e),a(t,[{key:"setSample",value:function(e){this.sample=e,this.hasSample=!0}},{key:"play",value:function(e,t,n){t||(t=this.audioContext.currentTime);var r=(0,l["default"])(this.audioContext,this.input,t,this.adsr),i=this.audioContext.createBufferSource();i.buffer=this.sample,i.connect(r),e+=Math.round(this.baseNote),i.playbackRate.value=Math.pow(this.semitoneRatio,e),n||(n=0),i.start(t,n,this.getPlayLength())}},{key:"getWaveform",value:function(e,t){for(var n=[],r=Math.floor(this.sample.length/e),i=this.sample.getChannelData(0),o=Number.MAX_VALUE,u=Number.MIN_VALUE,a=0;a<i.length;a+=r){var s=i[a];o>s&&(o=s),s>u&&(u=s),n.push(s)}t(n)}},{key:"getDuration",value:function(){return this.sample.duration}}]),t}(c["default"]);n["default"]=h},{"../util/adsr.js":17,"./baseInstrument.js":11}],15:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var s=e("./baseInstrument.js"),c=r(s),f=e("../util/adsr.js"),l=r(f),h=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.oscilators={SINE:"sine",SQUARE:"square",SAWTOOTH:"sawtooth",TRIANGLE:"triangle"},n.setOscilator("SINE"),n.baseFreq=440,n.continuousOsc=n.audioContext.createOscillator(),n}return u(t,e),a(t,[{key:"play",value:function(e,t){var n=this.adsr.attack+this.adsr.sustain+this.adsr.release,r=(0,l["default"])(this.audioContext,this.input,t,this.adsr),i=this.audioContext.createOscillator();i.connect(r),i.type=this.activeOscilator,i.frequency.value=this.baseFreq*Math.pow(this.semitoneRatio,e),i.start(t),i.stop(t+n)}},{key:"setOscilator",value:function(e){this.activeOscilator=this.oscilators[e]||this.oscilators.SINE}},{key:"setBaseFrequency",value:function(e){this.baseFreq=e,this.continuousOsc.frequency.value=this.baseFreq*Math.pow(this.semitoneRatio,0)}},{key:"start",value:function(){this.continuousOsc=this.audioContext.createOscillator(),this.continuousOsc.connect(this.input),this.continuousOsc.type=this.activeOscilator,this.continuousOsc.frequency.value=this.baseFreq*Math.pow(this.semitoneRatio,0),this.continuousOsc.start(0)}},{key:"stop",value:function(){this.continuousOsc.stop(0)}}]),t}(c["default"]);n["default"]=h},{"../util/adsr.js":17,"./baseInstrument.js":11}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){for(var t=2*e.sampleRate,n=e.createBuffer(2,t,e.sampleRate),r=n.getChannelData(0),i=n.getChannelData(1),o=0;t>o;o++)r[o]=2*Math.random()-1,i[o]=2*Math.random()-1;return n}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var c=e("./sampler.js"),f=r(c),l=function(e){function t(e){i(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e)),r=a(n.audioContext);return n.setSample(r),n.continuousBuffer=null,n.detuneValue=0,n}return u(t,e),s(t,[{key:"start",value:function(){this.continuousBuffer=this.audioContext.createBufferSource(),this.continuousBuffer.buffer=this.sample,this.continuousBuffer.connect(this.input),this.continuousBuffer.detune.value=this.detuneValue,this.continuousBuffer.loop=!0,this.continuousBuffer.start(0)}},{key:"stop",value:function(){this.continuousBuffer.stop(0),this.continuousBuffer.disconnect(this.input),this.continuousBuffer=null}},{key:"setDetuneValue",value:function(e){this.detuneValue=e,this.continuousBuffer&&(this.continuousBuffer.detune.value=this.detuneValue)}}]),t}(f["default"]);n["default"]=l},{"./sampler.js":14}],17:[function(e,t,n){"use strict";function r(e,t,n,r){var i=e.createGain();return i.connect(t),i.gain.setValueAtTime(0,n),i.gain.linearRampToValueAtTime(1,n+r.attack),i.gain.linearRampToValueAtTime(1,n+r.attack+r.sustain),i.gain.linearRampToValueAtTime(0,n+r.attack+r.sustain+r.release),i}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){r(this,e),this.audioContext=new AudioContext,this.masterCompressor=this.audioContext.createDynamicsCompressor(),this.masterCompressor.connect(this.audioContext.destination)}return i(e,[{key:"getCurrentTime",value:function(){return this.audioContext.currentTime}},{key:"getAudioContext",value:function(){return this.audioContext}}]),e}();n["default"]=o},{}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(t,n){var i=this;r(this,e),this.audioContext=t,this.noteScheduler=n,this.scheduleAheadTime=.1,this.nextNoteTime=0,this.lookahead=25,this.tempo=120,this.isRunning=!1,this.timerWorker=new Worker("scripts/workers/metronomeworker.js"),this.timerWorker.onmessage=function(e){"tick"===e.data&&i.scheduler()},this.timerWorker.postMessage({interval:this.lookahead})}return i(e,[{key:"scheduler",value:function(){if(this.nextNoteTime<this.audioContext.currentTime+this.scheduleAheadTime){this.noteScheduler.masterScheduler(this.nextNoteTime);var e=60/this.tempo;this.nextNoteTime+=.25*e}}},{key:"start",value:function(){this.isRunning?console.warn("Cannot start a running metronome"):(this.noteScheduler.start(),this.nextNoteTime=this.audioContext.currentTime,this.baseTime=this.nextNoteTime,this.timerWorker.postMessage("start"),this.isRunning=!0)}},{key:"stop",value:function(){this.noteScheduler.stop(),this.timerWorker.postMessage("stop"),this.isRunning=!1}},{key:"setTempo",value:function(e){this.tempo=e}},{key:"getTempo",value:function(){return this.tempo}}]),e}();n["default"]=o},{}],20:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return e+=1,e%16===0&&(e=0),e}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(t){r(this,e),this.audioContext=t,this.registry=new Set,this.beatNumber=0,this.noteToRender=0,this.lastNoteDrawn=0,this.isRunning=!1,this.nextScheduledTime=Number.MAX_VALUE}return o(e,[{key:"masterScheduler",value:function(e){var t=this;this.nextScheduledTime=e,this.registry.forEach(function(n){return n.processTick(t.beatNumber,e)}),this.noteToRender=this.beatNumber,this.beatNumber=i(this.beatNumber)}},{key:"register",value:function(e){this.registry.add(e)}},{key:"deregister",value:function(e){this.registry["delete"](e)}},{key:"start",value:function(){this.isRunning=!0,this.registry.forEach(function(e){return e.start()}),this._draw()}},{key:"stop",value:function(){this.isRunning=!1}},{key:"_draw",value:function(){var e=this;this.nextScheduledTime>=this.audioContext.currentTime&&this.noteToRender!==this.lastNoteDrawn&&(this.registry.forEach(function(t){return t.render(e.noteToRender,e.lastNoteDrawn)}),this.lastNoteDrawn=this.noteToRender),this.isRunning?requestAnimationFrame(this._draw.bind(this)):(this.beatNumber=0,this.lastBeatNumber=0,this.noteToRender=0,this.nextScheduledTime=Number.MAX_VALUE,this.registry.forEach(function(e){return e.stop()}))}}]),e}();n["default"]=u},{}],21:[function(e,t,n){"use strict";function r(){return Math.random()*Math.pow(2,31)>>>0}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{}],22:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("./line.js"),a=r(u),s=function(){function e(){i(this,e),this.currentLine=null}return o(e,[{key:"createLine",value:function(e,t){this.currentLine=new a["default"](e,t),this.helpers.addActiveLine(this.currentLine);
}},{key:"moveLine",value:function(e,t){this.currentLine.setPoint2(e,t),this.helpers.updateActiveLine(this.currentLine)}},{key:"finishLine",value:function(e,t,n,r,i){this.helpers.finishLine(this.currentLine,e,t,n,r,i)}},{key:"destroyLine",value:function(){this.currentLine=null,this.helpers.removeActiveLine(this.currentLine)}},{key:"setHelperFunctions",value:function(e){this.helpers=e}}]),e}();n["default"]=s},{"./line.js":23}],23:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("./point.js"),a=r(u),s=function(){function e(t,n){i(this,e),this.p1=new a["default"](t,n),this.p2=new a["default"](t,n)}return o(e,[{key:"setPoint1",value:function(e,t){this.p1.x=e,this.p1.y=t}},{key:"setPoint2",value:function(e,t){this.p2.x=e,this.p2.y=t}}]),e}();n["default"]=s},{"./point.js":24}],24:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function o(e,t){r(this,o),this.x=e,this.y=t};n["default"]=i},{}],25:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){for(var e=[],t=0;x>t;t++){var n=T.createEqualizer();n.connectTo(M.masterCompressor),e.push(n)}return e}function o(e,t){e.forEach(function(e,n){k["default"].getAudioSample(e,t).then(function(t){B.set(e,t.data)})})}function u(e,t){e.forEach(function(e){k["default"].getAudioSample(e,t).then(function(t){T.addReverbBuffer(e,t.data)})})}function a(e,t){k["default"].get(e).then(function(e){var n=e.data.sampleList,r=e.data.reverbBufferList;o(n,t),u(r,t)})["catch"](function(e){console.log("loadConfigFiles error:",e)})}function s(){(0,O["default"])().then(function(e){D.midiDeviceFactory=e})["catch"](function(){midiFactory={}}),a(C,M.getAudioContext())}Object.defineProperty(n,"__esModule",{value:!0}),n.scheduler=n.audio=void 0;var c=e("./audio/util/audioGraph.js"),f=r(c),l=e("./audio/util/metronome.js"),h=r(l),d=e("./audio/util/scheduler.js"),p=r(d),y=e("./audio/instruments/instrumentFactory.js"),v=r(y),b=e("./audio/effects/effectFactory.js"),m=r(b),w=e("./audio/effects/visualizer.js"),g=r(w),j=e("./midi/midiFactory.js"),O=r(j),_=e("./util/http.js"),k=r(_),C="config/example.json",x=3,M=new f["default"],P=new p["default"](M.getAudioContext()),E=new h["default"](M.getAudioContext(),P),T=new m["default"](M.getAudioContext()),S=new v["default"](M.getAudioContext()),B=new Map,A=i(),N=new g["default"](M.getAudioContext(),M.masterCompressor),D={audioGraph:M,metronome:E,sampleMap:B,lastEqualizerList:A,effectFactory:T,instrumentFactory:S,visualizer:N};s(),n.audio=D,n.scheduler=P},{"./audio/effects/effectFactory.js":7,"./audio/effects/visualizer.js":10,"./audio/instruments/instrumentFactory.js":13,"./audio/util/audioGraph.js":18,"./audio/util/metronome.js":19,"./audio/util/scheduler.js":20,"./midi/midiFactory.js":26,"./util/http.js":27}],26:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(){return navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(function(e){return new u(e)}):void console.warn("WebMidiApi not supported in this browser")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(t){r(this,e),this.midiAccess=t}return o(e,[{key:"getInputList",value:function(){var e=Array.from(this.midiAccess.inputs.values());return e}},{key:"getOutputList",value:function(){var e=Array.from(this.midiAccess.outputs.values());return e}},{key:"getInputByName",value:function(e){return Array.from(this.midiAccess.inputs.values()).find(function(t){return t.name===e})}},{key:"getOutputByName",value:function(e){return Array.from(this.midiAccess.outputs.values()).find(function(t){return t.name===e})}},{key:"getDeviceByName",value:function(e){return{input:this.getInputByName(e),output:this.getOutputByName(e)}}}]),e}();n["default"]=i},{}],27:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){var r=this;return r.xhr=new XMLHttpRequest,r.xhr.open(n,e),r.xhr.setRequestHeader("content-type","application/json;charset=UTF-8"),r.xhr.send(t),new Promise(function(e,t){r.xhr.addEventListener("load",function(n){try{var i=JSON.parse(r.xhr.responseText);e({data:i})}catch(o){t({data:r.xhr.responseText,error:o})}}),r.xhr.addEventListener("error",function(e){t({error:e})}),r.xhr.addEventListener("timeout",function(e){response.reject({error:error})})})}function o(e,t){var n=this;return n.audioContext=t,n.xhr=new XMLHttpRequest,n.xhr.open("GET",e,!0),n.xhr.responseType="arraybuffer",n.xhr.send(),new Promise(function(e,t){n.xhr.addEventListener("load",function(t){n.audioContext.decodeAudioData(n.xhr.response,function(t){e({data:t})})}),n.xhr.addEventListener("error",function(e){t({error:e})}),n.xhr.addEventListener("timeout",function(e){response.reject({error:error})})})}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return u(e,null,[{key:"get",value:function(e){return new i(e,void 0,"GET")}},{key:"getAudioSample",value:function(e,t){return new o(e,t)}},{key:"post",value:function(e,t){return new i(e,JSON.stringify(t),"POST")}}]),e}();n["default"]=a},{}]},{},[1]);