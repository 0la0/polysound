
<script>

function buildTouchBehaviors () {

  function getActiveTouchStates (touchStates, x, y, width, height) {
    return touchStates.filter((touchState) => {
      let xIsInBounds = touchState.column >= x && touchState.column <= (x + width);
      let yIsInBounds = touchState.row >= y && touchState.row <= (y + height);
      return xIsInBounds && yIsInBounds;
    });
  }

  function adjustSize (touchStates, x, y, width, height) {
    let activeStates = getActiveTouchStates.apply(this, arguments);
    if (activeStates.length > 1) {
      let lowerBound = activeStates[0];
      let upperBound = activeStates[1];

      let newWidth = Math.abs(upperBound.column - lowerBound.column);
      let newHeight = Math.abs(upperBound.row - lowerBound.row);
      let newX = Math.min(lowerBound.column, upperBound.column);
      let newY = Math.min(lowerBound.row, upperBound.row);

      this.setMatrix(newX, newY, newWidth + 1, newHeight + 1);
    }
  }

  function setRowValue (touchStates, x, y, width, height) {
    let activeStates = getActiveTouchStates.apply(this, arguments);
    if (activeStates.length) {
      this.targetRowIndex = activeStates[0].row;
    }
  }

  return {
    adjustSize: adjustSize,
    setRowValue: setRowValue
  }
}

</script>
